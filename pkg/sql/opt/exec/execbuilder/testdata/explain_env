# LogicTest: local !metamorphic
# We must turn off metamorphic variables because some are included in
# EXPLAIN (OPT, ENV) output.

statement ok
CREATE TABLE x (
  a INT PRIMARY KEY,
  b INT,
  INDEX (b),
  FAMILY "primary" (a, b)
)

statement ok
ALTER TABLE x INJECT STATISTICS '[
  {
    "columns": ["a"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 123123,
    "distinct_count": 100,
    "histo_buckets": []
  },
  {
    "columns": ["b"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 123123,
    "distinct_count": 123123,
    "histo_buckets": []
  }
]'

statement ok
CREATE TABLE y (
  u INT PRIMARY KEY,
  v INT REFERENCES x,
  INDEX (v),
  FAMILY "primary" (u, v)
)

query T
EXPLAIN (OPT, ENV) SELECT * FROM x WHERE b = 3
----
https://cockroachdb.github.io/text/decode.html#eJy0Vt9O47gXvp48xVFvBn5qIaW_C1Q00nZKVtvdUlCbmR2EkOUkJ6kXxza2UwqrleYheEKeZGWnQFmRZqXV9KJq3POdP9_5znF6PfiK2jAphjCW6Y2WNF2efgZcY5pUjGeowaKxsKqtgqDXA8q5vCNKo6IaCTVEKksUpwKW1IBdImSY04pbWFFe4RBknjtcKo0lJqXCkDtml2RjRVLJiWEP2ALPqMvknjfaTRbnXTg7vfTGG99M2J2-j7eNrabC0NQyKYjSTGpm75uAQuqS8ib0bUU5s_dE5sSgXrG0MQGNRcWpbnKkkWZECt6YxzM572ArgySXrlmovSPT5oSZurd5xTmxNOFY92sXbhHFDmjNLYdP7uQE4DWhZ0taWelCoPBeWak4S5klBjmmluRSk0q5DjeGEu_Bt8t1PhJq0yUxllosUdjmxN94Ewa1JTk1lihql_8KVFbcMuV-yIzlLKUuB-Ma7nlrYXrj5IEVD7Qgf0jWPDt10LVyNFGREVYIqZEIacmKGebcpJJXpTCECZJK1SYVJizqFeU7Z0lJYwuNxgE41QXWmnBqIFreNRLbD8PQY2S6mQBlWckeMCOKasscS5gRJjJce2-76xYuqNQZaswIp8a21OZU72VENC5liS5XUpOd7Y7kdphRnNUbinBWssZgR-H_jzcYX5v2o7ZkxspC07JFdW9RXkd-A1rapte3yG0FeD6xbb5VQawuygPDSsap227ELjWapeSN7IQHAw_VmKMmXMqbSnnBGj9w-U1rUC0VLVxLmFCVrbvJRNEC0-gNN6F2tsP3wtxyYmiOm_63ZeWuEiYK8kqpv50UalvpxA9zIyPv493ydK3QFUeitExowviOC6TBjaYikyUx2CzYGslKfJCicYC_xGNnVolUCmM1ZW7shHQbYuX535rB1gmpOVthaqXedVGLIBjPo1EcQTz6PI1AVQln6cEa9oIPFCaz-Bhm5zHMvkyn3eBDsjmpn8bns0U8H01mMayJusF7uJhPzkbzS_gtuoQ9CqPFeL8bfJjMTqNvsCYJYdka9hJ_HuyfBMFoGkfzf0aezH6NxjEs4lE8WcST8QI-XgUAAH_6b_fp0FXhXxI6Qwi7r8ebtdoZwtXLYW3feXm-3rbXSC1mhNrOEDpHYf-4F_Z7YR_C_jAMh2HY2TJ2VyYTqXv7qYQD9MPt2H6Z-Dcje69cYp1tsF-Lz8BtmFt3Lw6PBv2jgf_vr-5_LTn5ISX7DH9c1cH1x5MgiL5dTEeTGeydX8RdiGZf92ERTZ0o_gc_z8_PYA2__xLNI0jgEwxOgl6v1wv81bT-aSOzAJ4eH58evz89foeXebJDODw67A_h6nAAPTgcXAd_BwAA__-R-MTU


statement error ENV only supported with \(OPT\) option
EXPLAIN (ENV) SELECT * FROM x WHERE b = 3

#
# Multiple Tables.
#

query T
EXPLAIN (OPT, ENV) SELECT * FROM x, y WHERE b = 3
----
https://cockroachdb.github.io/text/decode.html#eJy0Vt9u27YXvq6e4sA3dX6wGzn5XQQOCsx11c1b6hS22rUoCoKSjmQuFMmSlGpnGFDsGXK5p8uTDKScxFkta8DQXAQ2_X3n73cOORzCO9SGSTGGqUyvtKTp6uULwDWmScV4hhosGgt1gwqC4RAo5_ILURoV1UioIVJZojgVsKIG7Aohw5xW3EJNeYVjkHnueKk0lpiUCkO-MLsiWxRJJSeGXWMHPaMukg1vxc2WlwN4_fKDB29tM2EP2j7bBVtNhaGpZVIQpZnUzG7aiELqkvI29ueKcmY3RObEoK5Z2hqAxqLiVLcZ0kgzIgVvjeOuOHu4lUGSS9cs1N6Q6TLCTNPbvOKcWJpwbPp1iLeMYke05jOH5-7kHOAhoDskrax0LlB4q6xUnKXMEoMcU0tyqUmlXIdbXYl99N10nY2E2nRFjKUWSxS2PfBH1oRBbUlOjSWK2tW_IpUVt0y5DzJjOUupi8G4hvu6dVR6a-SaFde0IL9J1j47jdO1cmWiIiOsEFIjEdKSmhnmzKSSV6UwhAmSStUlFSYs6pryg7OkpLGFRuMInOoCG004NRAtv7QWdhSGoefIdDsByrKSXWNGFNWWuSphRpjIcO2tHc5bOKdSZ6gxI5wa25GbU72XEdG4kiW6WElT7OywJ7fDjOKs2VCEs5K1OjsJ_3-25fjctB-1FTNWFpqWHap7zPI68hvQ0i69PmbuKsDXE7vmWxXE6qJ8ZljJOHXbjdiVRrOSvLU64bNTT9WYoyZcyqtKecEaP3D5VadTLRUtXEuYUJVtuslE0UHT6IFbVwfb4XthPnNiaI7b_ndF5a4SJgryUFJ_OynUttKJH-bWiuznu-XpWqErjkRpmdCE8QMXSIsZTUUmS2KwXbANk5V4LUXrAL-Npw5WiVQKYzVlbuyEdBui9vXfmcHOCWlqVmNqpT50UYsgmC6iSRxBPHlxEYGqEs7SZ2voB08ozObxGcwvY5i_vbgYBE-S7UnzbXo5X8aLyWwew5qoK9zAm8Xs9WTxAX6JPkCfwmQ5PRoET2bzl9F7WJOEsGwN_cSfB0fnQTC5iKPFPz3P5j9H0xiW8SSeLePZdAlPPwYAAL_7_-6vR-vCPxJ6YwgHD8fbtdobw8f7wwbfu__-aRevkVrMCLW9MfROwtHZMBwNwxGEo3EYjsOwtwN2VyYTqXv9VMIRRuGub79M_MvIbpQLrLdL9mvxjrhLc-vu3uDJ6ejk1P_2x-C_ppx8l5R9hN8v6-DT0_P9itw4RVbfKLJuU-RmjyKrO0U-wtUkd8hXl4to9uO8QdZHsIheRYtoPo2W99Ls0wc5O56Xc31Qzpu9cvZZRu_fXExmc-hfvokHEM3fHcEyunDY_8GrxeVrWA9gA7_-FC0iSOA5nJ4Hw-FwGDAhUA_9C6SfamnMUQC3N3_d3ny9vfkK_obefHOy_mE7f-6XP12tb29utoD7fWPHcHxyPBrDx-NTGMLx6adgB5YzblEb6Ftd4VHwdwAAAP__32YoHg==

#
# Same table twice should only show up once.
#

query T
EXPLAIN (OPT, ENV) SELECT * FROM x one, x two
----
https://cockroachdb.github.io/text/decode.html#eJy0Vs1u27gTP1dPMfClzh92Iaf_Q-CgB9f1At51ncJWiwZBQNDSSOaGIhly5DhZLNCHyHGfLk-yIOUkziKyFljUB0Mi5zcfv_lSvw_f0Dqh1RDGOr2ymqfrTx8Bt5iuKiEztEDoCDa1VBT1-8Cl1DfMWDTcIuOOaUPMSK5gzR3QGiHDnFeSYMNlhUPQee5xqXbEXMqVYzeC1mwnxVItmRN32ALPuPfkVjbKTZdnPfj86TwI73QLRQd1n-wLk-XK8ZSEVsxYoa2g2yag0rbksgl9XXEp6JbpnDm0G5E2OmCxqCS3TYos8oxpJRv9eCTnFWzlkOXaJwttUOTalAhX5zavpGTEVxLrfB3CLSeJB5K7lvDBn5wCPDv0KMkr0t4EqqBVlEaKVBBzKDEllmvLKuMz3GhKvQbfD9frWHFK18wRJyxRUbPjL7Qph5ZYzh0xw2n9r0BlJUkY_6AzkYuUex-cT3jgrYXpnZI7Udzxgv2uRXPv1Ea3xtPEVcZEobRFpjSxjXDCq0m1rErlmFAs1aatVIQitBsuD_aS0Y4Ki84DJLcF1jXhq4FZfdNI7CCO44DR6a4DDIlS3GHGDLckPEuYMaEy3AZth-NW3qi2GVrMmOSOWmLzVR_KiFlc6xK9r6wmOztsyc8wZ6SoJxSTohSNxo7j_5_sMCE2G1ptLRzpwvKypepeokIdhQlIvK1eXyL3KyDwiW39bQpGtijfOVEKyf10Y7S26NZaNrITv3sfoBZztExqfVWZULAuNFx-1WrUasMLnxKhTEV1NoUqWmAWg-DO1MF0hFy4a8kcz3GX_zav_CoRqmDPlIbtZNBSZVehmRsZeR3vh6dPha0kMmP1iq-EPLBAGtRYrjJdMofNBVsjRYl3WjU28Ndk7MUqlWrlyHLh205pPyE2gf-9HmztkJqzDaak7aFFraJovJiMkgkko4-zCZhqJUX6bgvd6A2H6Tw5gflZAvOvs1kverPandRv47P5MlmMpvMEtsxc4S18WUw_jxbn8NvkHLocRsvxUS96M51_mnyHLVsxkW2huwrn0dFpFI1myWTxT8vT-a-TcQLLZJRMl8l0vIS3FxEAwB_h3_86fFOEj4TOEOLe8_FurHaGcPF0WMt3nt4v9-UtcsKMceoMoXMcD0768aAfDyAeDON4GMedPWG_MoVK_ddPpTxgEO_bDsMkfBnRrfGOdfbBYSw-Avdhftw9KTx-Pzh-H-7-7P3XkFc_JeTg4c-LOrp8expFk-9fZqPpHLpnX5IeTObfjmA5mfmi-B_8sjj7DFsYLUEr7NVPdKNPo36_34-EUmj7YTt3U6udO4rg4f6vh_sfD_c_IGyvLVxw90ErvGy4ohsdru53V7mQhNZBl2yFR9HfAQAA___30N1I

#
# Set a relevant session variable to a non-default value and ensure it shows up
# in the environment dump.
#

statement ok
SET reorder_joins_limit = 63

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFO48gSfR5_Rb0NXBFgLqsVAvGQCWY3u8FBiWd20GhU6thlu5d2d9PdNoSn-Qi-kC9ZdTvswAjH-wZRnVPlc05Vj0bwmYzlSp7ARGU3RrGsOv8IdE_ZquEiJwOOrIO2q4qi0QiYEOoOtSHNDCGzqLRDLZiEillwFUFOBWuEg5aJhk5AFYXHZco6tBmTFu-4q3BThZkSaPkDDcBz5idZi9666XK-B5fn16F4w82l28p9_LLYGSYtyxxXErXhynC37gNKZWom-tC3DRPcrVEVaMm0POsdwFDZCGb6iAyxHJUUvXM8i_MGtrGEhfJmkQlEdoiE287bohECHVsJ6vzahlvGqQc6eyvgzP9yCvBjoOdK1jjlW5AMrLzWgmfcoSVBmcNCGWy0d7i3lXwL_vJzPceKuaxC65ijmqTrH_wVm7RkHBbMOtTMVf8JVDfCce3_UDkveMb8DNYbHnQbUHpD8sDLB1bi34r3707X9F57mZjMkZdSGUKpHLbcck-TKdHU0iKXmCk9FBUuHZmWia27pJV1pSHrAYKZkrpM-DSgUXe9wn44PDwMGJVtNkA7XvMHylEz47hXiXLkMqf7wLb9u6VvqkxOhnIUzLqBb_OpDzFCQ5Wqyc-Kndj59k7-hlkteHehUPCa9zb7_-EvxxtM-DYTVq3i1qnSsHogda9RIUfhAjo2lNfXyJcJCHrS0H7rEp0p633Lay6Yv27oKkO2UqJXncP9owA1VJBBodRNo0NgbVi44mawqVGald4SLnXjOje5LIduiqFQuenV-XEGvx69eV6CHfZWoGUFbSIwNJh_Tbgs8Yeq4YHSZFxjVmGfe0V5G-_vp3fDNIJQG7ViKy62vCE9NIbJXNVoqT-zHZLX9KBk7w5_Sie-rJGZktYZxv3mSeWPRBsseLGGg0vSadZS5pTZ9lbLKJos4nEaQzr-OItBNyvBs_017ETvGpgm6TEk8xSST7PZXvSu3fzS_TeZJ8t0MZ4mKaxR39AarhbTy_HiGv6Mr2GngfFysvtzXYuFr7yYL-Lpb0lX2e7CIr6IF3EyiZfPI9zvMA-eJufxl4Dj-T3stIE02j2NovEsjRc_jz1N_ognKSzTcTpdptPJEt5__fb-NIriL1ez8TSBnflVugdx8nkXlvHM1_4PLhbzS1jDX7_HixgaOIOj02g0Go2icPHWETw9Pj49fn96_A7_euNO4ODDCXw9OIIRHBx9i_4JAAD__wH3Y_o=

# Make sure it shows up correctly even if it matches the cluster setting.
statement ok
SET CLUSTER SETTING sql.defaults.reorder_joins_limit = 63


query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFO48gSfR5_Rb0NXBFgLqsVAvGQCWY3u8FBiWd20GhU6thlu5d2d9PdNoSn-Qi-kC9ZdTvswAjH-wZRnVPlc05Vj0bwmYzlSp7ARGU3RrGsOv8IdE_ZquEiJwOOrIO2q4qi0QiYEOoOtSHNDCGzqLRDLZiEillwFUFOBWuEg5aJhk5AFYXHZco6tBmTFu-4q3BThZkSaPkDDcBz5idZi9666XK-B5fn16F4w82l28p9_LLYGSYtyxxXErXhynC37gNKZWom-tC3DRPcrVEVaMm0POsdwFDZCGb6iAyxHJUUvXM8i_MGtrGEhfJmkQlEdoiE287bohECHVsJ6vzahlvGqQc6eyvgzP9yCvBjoOdK1jjlW5AMrLzWgmfcoSVBmcNCGWy0d7i3lXwL_vJzPceKuaxC65ijmqTrH_wVm7RkHBbMOtTMVf8JVDfCce3_UDkveMb8DNYbHnQbUHpD8sDLB1bi34r3707X9F57mZjMkZdSGUKpHLbcck-TKdHU0iKXmCk9FBUuHZmWia27pJV1pSHrAYKZkrpM-DSgUXe9wn44PDwMGJVtNkA7XvMHylEz47hXiXLkMqf7wLb9u6VvqkxOhnIUzLqBb_OpDzFCQ5Wqyc-Kndj59k7-hlkteHehUPCa9zb7_-EvxxtM-DYTVq3i1qnSsHogda9RIUfhAjo2lNfXyJcJCHrS0H7rEp0p633Lay6Yv27oKkO2UqJXncP9owA1VJBBodRNo0NgbVi44mawqVGald4SLnXjOje5LIduiqFQuenV-XEGvx69eV6CHfZWoGUFbSIwNJh_Tbgs8Yeq4YHSZFxjVmGfe0V5G-_vp3fDNIJQG7ViKy62vCE9NIbJXNVoqT-zHZLX9KBk7w5_Sie-rJGZktYZxv3mSeWPRBsseLGGg0vSadZS5pTZ9lbLKJos4nEaQzr-OItBNyvBs_017ETvGpgm6TEk8xSST7PZXvSu3fzS_TeZJ8t0MZ4mKaxR39AarhbTy_HiGv6Mr2GngfFysvtzXYuFr7yYL-Lpb0lX2e7CIr6IF3EyiZfPI9zvMA-eJufxl4Dj-T3stIE02j2NovEsjRc_jz1N_ognKSzTcTpdptPJEt5__fb-NIriL1ez8TSBnflVugdx8nkXlvHM1_4PLhbzS1jDX7_HixgaOIOj02g0Go2icPHWETw9Pj49fn96_A7_euNO4ODDCXw9OIIRHBx9i_4JAAD__wH3Y_o=

statement ok
SET enable_zigzag_join = false

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFO48gSfR5_Rb0NXBFgLqsVAvGQCWY3u8FBiWd20GhU6thlu5d2d9PdNoSn-Qi-kC9ZdTvswAjH-wZRnVPlU-dUj0bwmYzlSp7ARGU3RrGsOv8IdE_ZquEiJwOOrIO2q4qi0QiYEOoOtSHNDCGzqLRDLZiEillwFUFOBWuEg5aJhk5AFYXHZco6tBmTFu-4q3BThZkSaPkDDcBz5idZi9666XK-B5fn16F4w82l28p9_LLYGSYtyxxXErXhynC37gNKZWom-tC3DRPcrVEVaMm0POsdwFDZCGb6iAyxHJUUvXM8i_MGtrGEhfLLIhOI7BAJt91ui0YIdGwlqNvXNtwyTj3Q2VsBZ_6XU4AfAz1XssYp34JkYOW1FjzjDi0JyhwWymCj_YZ7W8m34C8_13OsmMsqtI45qkm6_sFfsUlLxmHBrEPNXPWfQHUjHNf-D5XzgmfMz2D9woNuQ4ptWB54-cBK_FtxuUW8TeN77aViMkdeSmUIpXLYcss9U6ZEU0uLXGKm9JBduHRkWia25kkr60pD1gMEMyV1vvCOQKPuesX9cHh4GDAq26RAO17zB8pRM-O4V4py5DKn-8C2XXDpmyqTk6EcBbNu4Nu884OV0FClavKzYqd3vr2Tv2NWC95dKRS85r3N_n_4y_EGE77NhLhV3DpVGlYPOO81KngpXEHHhjz7GvnSAUFPGsq4LtGZst63vOaC-QuHrjJkKyV61TncPwpQQwUZFErdNDp41obQFTeDTY3SrPQr4VI3rtsml-VQSgyFyk2vbh9n8OvRmykJ67C3Ai0raGOBocH8i8JliT9UDY-UJuMaswqZ7hXlbby_oX4bphGE2qgVW3Gx5R3poTFM5qpGS_2e7ZC8pgclezP8KZ34skZmSlpnGPfJk8ofiTas4EUMB0PSadZS5pTZ9l7LKJos4nEaQzr-OItBNyvBs_017ETvGpgm6TEk8xSST7PZXvSu3fzS_TeZJ8t0MZ4mKaxR39AarhbTy_HiGv6Mr2GngfFysvtzXYuFr7yYL-Lpb0lX2e7CIr6IF3EyiZfPI9zvMA-eJufxl4Dj-T3stIE02j2NovEsjRc_jz1N_ognKSzTcTpdptPJEt5__fb-NIriL1ez8TSBnflVugdx8nkXlvHM1_4PLhbzS1jDX7_HixgaOIOj02g0Go2icPHWETw9Pj49fn96_A7_7sadwMGHE_h6cAQjODj6Fv0TAAD__4w5ZFw=

statement ok
SET optimizer_use_histograms = false

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFO48gSfR5_Rb0NXBFgLqsVAvGQCWY3u8FBiWd20GhU6thlu5d2d9PdNoSn-Qi-kC9ZdTvswAjH-wbROafK51RVj0bwmYzlSp7ARGU3RrGsOv8IdE_ZquEiJwOOrIO2Q0XRaARMCHWH2pBmhpBZVNqhFkxCxSy4iiCngjXCQctEQyegisLzMmUd2oxJi3fcVbhBYaYEWv5AA_Sc-U7Wohc3Xc734PL8OoA32ly6rdrHL8HOMGlZ5riSqA1Xhrt1H1EqUzPRx75tmOBujapAS6blWW8DhspGMNMnZIjlqKTo7ePZnDe4jSUslA-LTBCyQyLcdtkWjRDo2EpQl9c23jJOPdHZWwFn_pdTgB8NPSNZ45QvQTKo8loLnnGHlgRlDgtlsNE-4d5S8i36y8_1GivmsgqtY45qkq6_8Vdq0pJxWDDrUDNX_SdS3QjHtf9D5bzgGfM9WB948G3IsY3KAy8fWIl_Ky63mLcpfK-9VUzmyEupDKFUDltuuVfKlGhqaZFLzJQeGhcuHZmWia37pJV1pSHrCYKZkrq58BOBRt31mvvh8PAwcFS22QLteM0fKEfNjOPeKcqRy5zug9p2w6UvqkxOhnIUzLqBb_OTH0YJDVWqJt8rdn7n2yv5O2a14N2VQsFr3lvs_4e_HIcknz_OhH2ruHWqNKy2g3m-JoZ5CpfQsaG5fc18OQXBUxrac12iM2W9b3nNBfNXDl1lyFZK9Dp0uH8UqIYKMiiUuml0mFsbFq-4GSxqlGalj4VL3bguUS7LoU0xFJCbWl0mZ_Dr0ZvOhnNubwVaVtBmDIYa868KlyX-cDU8VJqMa8wq7HWvKW_z_R31aZhGEGqjVmzFxZa3pEfGMJmrGi31z23H5DU9KNm7x5_SiYc1MlPSOsO43z6p_KFoQwQvVnFwUTrPWsqcMtvebBlFk0U8TmNIxx9nMehmJXi2v4ad6F0D0yQ9hmSeQvJpNtuL3rWbX7r_JvNkmS7G0ySFNeobWsPVYno5XlzDn_E17DQwXk52f8a1WHjkxXwRT39LOmS7C4v4Il7EySRePrdwv8M8eZqcx18Cj-f3sNMG0Wj3NIrGszRe_Nz2NPkjnqSwTMfpdJlOJ0t4__Xb-9Moir9czcbTBHbmV-kexMnnXVjGM4_9H1ws5pewhr9-jxcxNHAGR6fRaDQaReHqrSN4enx8evz-9Pgd_s3GncDBhxP4enAEIzg4-hb9EwAA__8HmmS-

statement ok
SET optimizer_use_multicol_stats = false

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFS20YUfY6-4r4FOhhI6XQYGB4cI1q3RmZsJQ2TydxZS1fSltXusrsSmKd8BF_Il3R2ZRqaIitv4Dnn3Ktz7r07GsFHMpYreQITld0YxbLq_D3QPWWrhoucDDiyDtoOFUWjETAh1B1qQ5oZQmZRaYdaMAkVs-AqgpwK1ggHLRMNnYAqCs_LlHVoMyYt3nFX4QaFmRJo-QMN0HPmO1mLXtx0Od-Dy_PrAN5oc-m2ah-_BDvDpGWZ40qiNlwZ7tZ9RKlMzUQf-7Zhgrs1qgItmZZnvQ0YKhvBTJ-QIZajkqK3j2dzXuE2lrBQPiwyQcgOiXDbZVs0QqBjK0FdXtt4yzj1RGdvBZz5X04BvjX0jGSNU74EyaDKay14xh1aEpQ5LJTBRvuEe0vJ1-gvP9drrJjLKrSOOapJuv7G_6MmLRmHBbMONXPVD5HqRjiu_R8q5wXPmO_B-sCDb0OObVQeePnASvxbcbnFvE3he-2tYjJHXkplCKVy2HLLvVKmRFNLi1xipvTQuHDpyLRMbN0nrawrDVlPEMyU1M2Fnwg06q7X3HeHh4eBo7LNFmjHa_5AOWpmHPdOUY5c5nQf1LYbLn1RZXIylKNg1g18m5_8MEpoqFI1-V6x8zvfXsnfMasF764UCl7z3mI_H_5yHJJ8_jgT9q3i1qnSsNpuz_P_zDBQ4RQ65gbYXa8vyC8nIfhKQ7uuS3SmrPctr7lg_tKhqwzZSolelw73jwLVUEEGhVI3jQ6za8PyFTeDRY3SrPTRcKkb16XKZTm0LYYCclOry-UMfj161Z9w0u2tQMsK2ozCUGP-ZeGyxG-uhsdKk3GNWYXd7jXldb6_pT4N0whCbdSKrbjY8p70yBgmc1Wjpf7Z7Zi8pgcle3f5QzrxsEZmSlpnGPcbKJU_Fm2I4MU6Di5L51lLmVNm27sto2iyiMdpDOn4_SwG3awEz_bXsBO9aWCapMeQzFNIPsxme9GbdvNL999knizTxXiapLBGfUNruFpML8eLa_gzvoadBsbLye73uBYLj7yYL-Lpb0mHbHdhEV_EiziZxMvnFu53mCdPk_P4U-Dx_B522iAa7Z5G0XiWxovv254mf8STFJbpOJ0u0-lkCW8_f3l7GkXxp6vZeJrAzvwq3YM4-bgLy3jmsT_BxWJ-CWv46_d4EUMDZ3B0Go1Go1EULt86gqfHx6fHr0-PX-HfbNwJHLw7gc8HRzCCg6Mv0T8BAAD__8VOZSA=

statement ok
RESET reorder_joins_limit

statement ok
RESET enable_zigzag_join

statement ok
RESET optimizer_use_histograms

statement ok
RESET optimizer_use_multicol_stats

#
# Test sequences.
#

statement ok
CREATE SEQUENCE seq

query T
EXPLAIN (OPT, ENV) SELECT * FROM seq
----
https://cockroachdb.github.io/text/decode.html#eJyMVcFu20gMvfsr5ri7qAMnbptsgx68rhYIEDvd2Am6J2IsURI3o5kxh3ISf_1iRi6SAJHVm2DzPXIeH8nxWN0jB3L2i5q7_IGdzutvfyl8wnzTkimQlWAQteuiRqPxWGlj3CN4Rq8ZQQdwXsAbbVWtg5IaVYGlbo2onTYtflGuLCMud0Eg5NoGeCSp4RAFuTMQaI8D8ELHSp5Nb9zV6uaDWnz7NwUfuMnKUe6L18HC2gadCzkLnskxyXMf0DputOlDb1ttSJ7BlRCQd5T3FsBYtUZzHxGjLsBZ01vHT3HewbYBoXSxWciJKAyRUOh6W7bGgOiNwa5fx3CrbB2BErZGfY2_XCr1UtDPSN2KiynQJlZqvKGcBAIazAVKx9D62OHeVPY9-OvnRo6NlryGIFqwQSv9hb9hswFZoNRBwGupfwnUtEbIxw9XUEm5jjWE2PCk24DSB5I9VXtdwX-O-menS_rko0zaFkCVdYxgncCOAkWa3Jm2sQHIQu78kFXICvJOm6Oz5F2QijFEgNFcYeeJ6AZg99gr7OlkMkkYlx8mwAs1tMcCvGahqBIWQLbAp8R2_N02JnVcIGMBRgcZeFt0fbIRMNauwVgrdGIXxzPFHRa8oW5DgaGGepOdTT5eHDDpbZxGraYgrmLdDLjuLSr5KG1A0UN-fYt87YCkJw7Nt69AuGpOAjVkdNxuIDVjqJ3pVWdyMk1QxhIZjHMPrU-GDWngyofBpOy8rmJLyPpWum6SrYZ2CmOKPOTq-vFVfZ6-u15SO8LWQNAlHiwwVFi8JmQreFE1HSiPLC1v0jz3ivI-Pu7P2A1uDYJnt9EbMkduSA8Na1u4BgL2e7ZDUoN7Z3tn-G49j2GtzZ0Nwpri5FkXl8QuteDVGA4OSafZDnNxfOxW29FofpvN1plaZf_cZct5pny7MZSfBNyqxdXyfnZ9l6lTtZj96D7_PDubTs_PJtPPF58-np9_upicq6vl_DZbZMu1OlWr9ex2rU4vR6Psx_fr2dVS_Xbzff1BZcv739Uqu87ma_WH-vv2ZqECbi9H4_F4PAq4bdHmOO4OTPxn9H8AAAD__7g4MWs=

#
# Test views.
#

statement ok
CREATE VIEW v AS SELECT a, b, u, v FROM x, y WHERE b = 3

query T
EXPLAIN (OPT, ENV) SELECT * FROM v
----
https://cockroachdb.github.io/text/decode.html#eJy0Vt9u27YXvo6e4sA3tX-wEzn-YQgcFJjrqpu31C5s9R-KgqCkI5kLRaokpdgZBhR7hlzu6fIkAyk7cVbLHjC0F0VEf9_5-51D9nrwDpVmUgxhLONrJWm8fPkCcIVxVDKeoAKD2kBVozyv1wPKubwhhcKCKiRUE1kYUnAqYEk1mCVCgiktuYGK8hKHINPU8mKpDdExFZrcMLMkGxSJJSea3eIRekJtJGveiJssZl14_fKjA29sM2EO2r7YBRtFhaaxYVKQQjGpmFk3EYVUOeVN7C8l5cysiUyJRlWxuDEAhVnJqWoypJAmRAreGMe2OHu4pUaSStssVM6QPmaE6bq3ack5MTTiWPfrEG8RhJZo9BcOz-3JJcBjQFskLY20LlA4qywvOIuZIRo5xoakUpGysB1udCX20XfTtTYiauIl0YYazFGY5sCfWBMalSEp1YYU1Cz_FSkvuWGF_UMmLGUxtTFo23BXtyOV3hi5ZdktzchvkjXPTu10VdgyUZEQlgmpkAhpSMU0s2ZiyctcaMIEiWVxTCpMGFQV5QdnqZDaZAq1JXCqMqw1YdVAlLxpLGzf933HkfFmAgrDcnaLCSmoMsxWCRPCRIIrZ-1w3sI6lSpBhQnhVJsjuVnVOxkRhUuZo42V1MVODnuyO0wXnNUbinCWs0Zn5_7_LzYcl5tyo7Zk2shM0fyI6p6ynI7cBjT0mF6fMncV4OqJx-a7yIhRWX6qWc44tduNmKVCvZS8sTr-6cBRFaaoCJfyuiycYLUbuPT6qFMlC5rZljBRlKbuJhPZsZ2i0CE3vup-PIcfBnvXi2uH_sKJpiluJHAsMHubMJGRx6q6C6pAZUoVuXluLMp-vt2fthuq5EgKJSMaMX7gDmkwo6hIZE40Nmu2ZrIcb6VonOG34djCShFLoY2izE6ekHZJVK4FO2N4dEjqmlUYG6kO3dXC88bzYBQGEI5eXAVQlBFn8ekK2t4Jhck0vIDpLITp26urrncSbU7qr_Fsugjno8k0hBUprnENb-aT16P5R_g1-AhtCqPFuNP1TibTl8EHWJGIsGQF7cide51LzxtdhcH8n54n01-CcQiLcBROFuFkvIBnnzwAgN_d__Zfi1aZeye0huB3H483m7U1hE8PhzW-9fD9eRevkBpMCDWtIbTO_f5Fz-_3_D74_aHvD32_tQO2tyYTsX0AlcIS-v6ub7dP3OPIrAsbWGuX7DbjlrhLsxvvweD5oH8-cL_90f2vKUffJWUX4ffL2vv87HK_ItdWkeU3iqyaFLneo8hyq8gnuIqkFvlqNg8mP01rZNWBefAqmAfTcbB4kGabPsrZ8pycq4NyXu-V826W7ybB-y26cmNnB63rnZQ2Pa8DowUsgitrg3Yh6kLZhQpezWev3S463QbXffK5hvc_B_MAIngOg0vPCz68uRpNptCevQm7EEzfdbZG_1fbqi69Xq_X85gQqHruidOOldS648H93V_3d1_v776CewKsvzlZ_biZbvvLn7aT93d3G8DDNjNDODs_6w_h09kAenA2-OztwFLGDSoNbaNK7Hh_BwAA__84MEGu

#
# Test tables in user-defined schemas.
#

statement ok
CREATE SCHEMA s;
CREATE TABLE s.t (a int primary key)

query T
EXPLAIN (OPT, ENV) SELECT * FROM s.t;
----
https://cockroachdb.github.io/text/decode.html#eJyMVV1v20YQfA5_xb3FLizDbYrCiJEHRVEBtbJsSExQoygWJ3JJbn28O-8t5Y9fX9xRQWTAFPsmCDuzy9mZvclEfUMO5OxHNXPFPTtdNF8-K3zCYtuRKZGVYBC166uybDJR2hj3CJ7Ra0bQAZwX8EZb1eigpEFVYqU7I2qnTYcflauqiCtcEAiFtgEeSRrYV0HhDAR6wRF4qeMkz2awbrG5OVPXX-5S8Z6brBzlvjwsFtY26ELIWfBMjkmeh4DWcavNEPqh04bkGVwFAXlHxeAAjHVnNA8RMeoSnDWDc3wX5w1sFxAqF5eFnIjCGAmFfrdVZwyI3hrs93UMt5nnESjhwahP8Z8rpX4M9L1Sd-JiC7SJlVpvqCCBgAYLgcoxdD5ueLCVfQt--LmRY6ulaCCIFmzRyvDgr9hsQBaodBDwWpr_BWo7I-TjD1dSRYWOM4S48KTbiNJ7kheqX3QN_zoazk7f9MlHmbQtgWrrGME6gR0FijSFM11rA5CFwvkxq5AV5J02R7PkXZCaMUSA0Vxj74noBmD3OCjszxcXFwnjin0CvFBLL1iC1ywUVcISyJb4lNiOf7eNTR2XyFiC0UFGvi26PtkIGBvXYpwVerHL453iDQveUH-hwFBLg81-ufj1co9J38Ypag0FcTXrdsR1r1HJR-kCih7z62vkoQOSnjiWb1-DcN2eB2rJ6HjdQBrG0DgzqM7F-YcEZayQwTh33_lk2JACV92PNmXndR1XQtZ30m-TbD12UxhT5b5Xv49P6rcPb56XtI7wYCDoCvcWGBssviZka_ihanqgPLJ0vE15HhTlbXy8n3Eb3BkEz26rt2SOvCEDNKxt6VoIOOzZHkktvjg7mOGv-SyWdbZwNghrismzLh6JXVrBQQxHQ9JrtsNCHB97q22WzdbzaT5X-fTzcq7CuaiT7J1Wi1V-qVY3uVp9XS7Psnezm9UmX08Xq1wJ-Ht8VrfrxfV0faf-nN-pE62mm9lpdnqVZdNlPl8f0C1Wf8xnudrk03yxyRezjXr_9z_vr7Js_tftcrpYqZOb2_xMzVffTtVmvoy1P6nf1zfXEX2VTSaTSZZOj2T_BQAA__8KsjQT

#
# Test default_transaction_quality_of_service settings.
#

statement ok
SET default_transaction_quality_of_service=background

query T
EXPLAIN (OPT, ENV) VALUES(1);
----
https://cockroachdb.github.io/text/decode.html#eJyMVcFu3EYMvesr5mgD3sBuiiJI4EOa-BAgTQLYMdoTwZUoifVoOOZQa3tP-Qh_ob-kmNEGsYHVqrfFgu-R8_getVq5a9LEEt66D1LfqGDdf_zT0T3V65F9Q-qMkrnNVFVVq5VD7-UOolJEJcAEEg2ix-B6TM56cg21OHpzG_QjvXXSthlXSzJINYYEd2w97KqgFg-Jt7QAbzBP8uBn6z5dfj1xf338pxTvuDnYQe43z4tNMSSsjSVAVBZle5gDBtEBfXV5cbUXfjuiZ3sAaSGRbrgmd-7WWN90KmNo3jn3q-9PSqVu9KhzEylhAxL87Eg_ddqDHRNBK3lvpIUoLZFwmtbcjt6D4drTtLpDuCIGJ0u33p3nf_Y-E0eT3IJCYeUheq7ZIJGn2qAVhTHmZc-2Cvvgz5-bOdZodQ_J0GigYPODv2ALidSgxWQQ0fr_BRpGbxzzD2m45RrzDCmvvui2oPSOZMvdFjv4V3g-RlPT-5hlwtAAd0GUIIjBhhNnmlr8OIQEHKCWuGQVDka6QX8wVlGSdUopAzxqR5MnshtA5W5W2LPT09OCkXqXhWg88JYaiKjGWSVqgEND94Xt8LtDbirakFIDHpMtvC27vtgIlHoZKM8Kk9jN4U75nKXoeTpW4Hng2Wa_nf7-Zocpb9MStZ6TSac4LLjuJar4qBxDwyW_vkQ-d0DRk5byHTsw7YZXiQf2mA8dWK-UevGz6py-el2gSi0peJGbMRbDphK49maxqUrELq-EQxxt2iaHbummKJXKXa9pH-fuj9d7z0tZR7r1kLClnQWWBssfFg4d_FK1fKsiqY26LnmeFWU_Pt_PvA0dPUFUWeOa_YHPyQyNYmhkgETznp2QPNBWwmyGv199yGVjqCUkU-ScvCD5SGzKCp7FcDEkk2Ybqk300Gc7VNXF398-v__0xR19_XZ14i6-XB-76_efv19cuqOz43fVarVaVaU8Ve7p8fHp8cfT4w93dHZyXP0XAAD__6zsHWg=

statement ok
SET default_transaction_quality_of_service=critical

query T
EXPLAIN (OPT, ENV) VALUES(1);
----
https://cockroachdb.github.io/text/decode.html#eJyMVcFuG0cMvesr5mgDVmA3RREk8CFNfAiQJgHsGO2JoGa5K9azwzGHK9s65SP8hf6SYmYVxAa02t4Ege-R8_ged7l016SZJb51H8TfqKBff_zT0T351cChIXVG2dxmrFoslkuHIcgdJKWESoAZJBmkgNGtMTtbk2uoxSGY22AY6K2Tti04L9kge4wZ7tjWsKsCLwEyb2kG3mCZ5CFM1n26_Hri_vr4Ty3ecXO0g9xvnhebYszojSVCUhZle5gCRtEew-Ly4mov_HbAwPYA0kIm3bAnd-68srHH8M65X11_Eip1Q0CdmkcJG5AYJgf6qdIe7JAJWilbI61EeY6E87jkdggBDFeBxsUdwlUpOFu-De68_LP3mTiYlBYUKyv3KbBng0yBvEErCkMqq55sFffBnz-3cKzQ_BqyoVFP0aYHf8EWM6lBi9kgoa3_F6gfgnEqP6Thlj2WGXJZfNVtRukdyZa7LXbwr_B0iMam96nIhLEB7qIoQRSDDWcuNF7C0McMHMFLmrMKRyPdYDgYqiTZOqVcAAG1o9ETxQ2gcjcp7Nnp6WnFiN8lIRn3vKUGEqpxUYka4NjQfWU7_O5Ymoo2pNRAwGwzbyuurzYCpbX0VGaFUezmcKdyzHIKPJ4qCNzzZLPfTn9_s8PUt2mN2pqzSafYz7juJar6qJ5Cwzm_vkQ-d0DVk-bynTow7fpXmXsOWM4c2FopryVMqnP66nWFKrWkEERuhlQNm2vg2pvZpioJu7ISjmmwcZscu7mbolQrd73GfZy7P17vPS91Hfk2QMaWdhaYG6x8Vjh28EvV-qVKpDboquZ5UpT9-HI_yzZ0CARJZYUrDgc-JhM0irGRHjJNe3ZEck9biZMZ_n71oZQN0UvMpsgleVHKkdjUFTyL4WxIRs025E300Ec7LhYXf3_7_P7TF3f09dvVibv4cn3srt9__n5x6Y7Ojt8tlsvlclHL88I9PT4-Pf54evzhjs5Ojhf_BQAA__-sDByT
